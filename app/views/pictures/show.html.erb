<p id="notice"><%= notice %></p>

<!--<div class="cssThumb">-->
<div class="span4">
<div class="pin">
  <div class="img-polaroid">
<figure class="single-image-view polaroid-images">
   <%= link_to image_tag(@picture.image_url(:fixedWidth).to_s), @picture.image_url, :class => 'title-img', :rel => 'lightbox', :title => @picture.name %>
</figure>
<div class="pic_likes">
  <%= link_to("Download", options = {:controller => :pictures, :action => :download, :id => @picture.id}, html_options = {:class => "start-challenge btn btn-mini btn-danger"}) %>
  <%= link_to "Start Challenge", new_picture_path(:challenge_picture => @picture.id), :class => "start-challenge btn btn-mini btn-info" %>
   <%= link_to "Details", picture_path(:id => @picture.id), :class => "start-challenge btn btn-mini" %>
 <div class="likes">
    <span class="badge badge-important number-likes"><%= @picture.pic_likes %></span>
   <% if user_signed_in? %>
   <%= link_to "<i class='icon-thumbs-up'></i>".html_safe, root_url(:like_id => @picture.id), { :method => :get, :class => "btn btn-mini btn-like"} %>
   <% end %>
 </div>
</div>
</div>
<!--</div>-->
<div class="text">
<hr class="hr-split-visible">
  <p><b>Comments:</b></p>
<div id="ajaxComments<%= @picture.id %>" class="ajaxComments">
  <% @comments = Comment.where(:picture_id => @picture.id) %>
  <%= render :template => 'comments/index', :locals => { :commments => @comments }%>
  <% @picture_id = @picture.id %>
  <% if user_signed_in? %>
  <%= render :partial => 'comments/form', :locals => { :picture_id => @picture_id} %>
  <% end %>
</div>
</div>
</div>
</div>
<div class="span6">
<p>
  <b>Name:</b>
  <%= @picture.name %>
</p>

<p>
  <b>Description:</b>
  <%= @picture.description %>
</p>

<p>
  <b>Type:</b>
  <%= @picture.type %>
</p>
<% if @parent %>
<p>
  <b>Parent:</b>
  <%= link_to @parent.name, picture_path(@picture.parent)  %>
</p>
<% end %>

<p>
  <b>Gallery:</b>
  <%= @picture.gallery %>
</p>

<p>
  <b>Rating:</b>
  <%= @picture.rating %>
</p>

<p>
  <b>Creator:</b>
  <%= link_to @picture.user.username.split(' ').map {|w| w.capitalize }.join(' '), user_path(@picture.user)  %>
</p>

<p>
  <b>Picture-likes:</b>
  <%= @picture.pic_likes %>
</p>
</div>
<hr class="hr-split-visible">
<p>
  <b>Changed Versions:</b>
  <% @children.sort_by{|e| e.pic_likes}.reverse_each do |picture| %>
      <div class="pin">
          <div class="img-polaroid">
            <figure class="polaroid-images">
               <%= link_to image_tag(picture.image_url(:fixedWidth).to_s), picture.image_url, :class => 'title-img', :rel => 'lightbox[gallery1]', :title => picture.name %>
              <figcaption class="pic_name"><%= picture.name %></figcaption>
            </figure>
          <div class="pic_likes">
            <%= link_to("Download", options = {:controller => :pictures, :action => :download, :id => picture.id}, html_options = {:class => "start-challenge btn btn-mini btn-danger"}) %>
            <%= link_to "Start Challenge", new_picture_path(:challenge_picture => picture.id), :class => "start-challenge btn btn-mini btn-info" %>
             <%= link_to "Details", picture_path(:id => picture.id), :class => "start-challenge btn btn-mini" %>
           <div class="likes">
              <span class="badge badge-important number-likes"><%= picture.pic_likes %></span>
             <% if user_signed_in? %>
             <%= link_to "<i class='icon-thumbs-up'></i>".html_safe, root_url(:like_id => picture.id), { :method => :get, :class => "btn btn-mini btn-like"} %>
             <% end %>
           </div>
          </div>
            <hr class="hr-split">
            <!--<div class="fb-like" data-send="true" data-layout="box_count" data-width="450" data-show-faces="true"></div>-->
         </div>
         <div class="text">
            <div class="pic_creator">
              <% if picture.user.profil_pic.present? %>
                <%= link_to image_tag(picture.user.profil_pic_url(:thumb).to_s), user_path(picture.user), :class => 'user-img' %>
              <% else %>
                <%= link_to image_tag('default_profil_pic.jpg'), user_path(picture.user), :class => 'user-img' %>
              <% end %>
              <p><%= link_to picture.user.username.split(' ').map {|w| w.capitalize }.join(' '), user_path(picture.user)  %> created this picture.</p>
              <hr class="hr-split">
              <% if picture.parent %>
                <%= link_to image_tag(Picture.find(picture.parent).user.profil_pic_url(:thumb).to_s), user_path(picture.user), :class => 'user-img' %>
                <p><%= link_to picture.user.username.split(' ').map {|w| w.capitalize }.join(' '), user_path(picture.user)  %> modified it.</p>
               <hr class="hr-split">
              <% end %>
            </div>
            <% if picture.description? %>
              <div class="pic_description">
                <p>description: <%= picture.description %></p>
              </div>
            <% end %>
            <hr class="hr-split-visible">
            <div id="ajaxComments<%= picture.id %>" class="ajaxComments">
              <% @comments = Comment.where(:picture_id => picture.id) %>
              <%= render :template => 'comments/index', :locals => { :commments => @comments }%>
              <% @picture_id = picture.id %>
              <% if user_signed_in? %>
              <%= render :partial => 'comments/form', :locals => { :picture_id => @picture_id} %>
              <% end %>
            </div>
          </div>
      </div>
  <% end %>
</p>
